---
title: "easier_manual"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{easier_manual}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(easier)
```

---

# Introduction {#introduction} 

This vignette describes how to use the `r BiocStyle::Biocpkg("easier")` package for the prediction and interpretation of cancer patients' systems immune response.

Users can provide bulk tumor RNA-seq data as input.

This packages includes a Shiny application to allow users to explore patient-specific systems biomarkers of the immune response.

To understand the essentials of `r BiocStyle::Biocpkg("easier")` package, we recommend reading the following preprint [article](https://www.biorxiv.org/content/10.1101/2021.02.05.429977v1).

# Getting started {#gettingstarted}

Easier can be installed as follows:

```{r eval = FALSE}
# install.packages("~/ownCloud/SystemsImmunoOncology/Mechanistic_signatures_project/easier_1.0.3.tar.gz", repos = NULL, type="source")
library(easier)
````

## Computation of system-based signatures of the tumor microenvironment

```{r eval = FALSE}
# Example: Riaz
data("Riaz_data")

# Computation of cell fractions
cell_fractions <- compute_cell_fractions(RNA_tpm = Riaz_data$tpm_RNAseq)

# Computation of pathway scores
pathway_activity <- compute_pathways_scores(RNA_counts = Riaz_data$raw_counts_RNAseq,
                                            remove_genes_ICB_proxies = TRUE)

# Computation of TF activity
tf_activity <- compute_TF_activity(RNA_tpm = Riaz_data$tpm_RNAseq, 
                                   remove_genes_ICB_proxies = FALSE)

# Computation of ligand-receptor pair weights
lrpairs_weights <- compute_LR_pairs(RNA_tpm = Riaz_data$tpm_RNAseq, 
                                    remove_genes_ICB_proxies = FALSE, 
                                    cancertype = "pancan")

# Computation of cell-cell interaction scores
ccpair_scores <- compute_CC_pairs_grouped(lrpairs = lrpairs_weights, 
                                          cancertype = "pancan")
````

## Computation of different hallmarks of the immune response

```{r eval = FALSE}
tasks <- c("CYT", "Roh_IS", "chemokines", "Davoli_IS", "IFNy", "Ayers_expIS", "Tcell_inflamed", "RIR", "TLS")
immune_response <- compute_gold_standards(RNA_tpm = Riaz_data$tpm_RNAseq, 
                                          list_gold_standards = tasks, 
                                          cancertype = "SKCM",
                                          output_file_path = "/Users/Oscar/Desktop/Riaz")
```

## Predict patients' immune response

```{r eval = FALSE}
predictions_immune_response <- predict_immune_response(pathways = pathways_activity,
                                                       immunecells = cell_fractions,
                                                       lrpairs = lrpairs_weights,
                                                       tfs = tf_activity,
                                                       ccpairs = ccpairs_scores,
                                                       cancertype = "SKCM")
```



## Assess patient-specific likelihood of response to ICB therapy

```{r eval = FALSE}
compare_immune_response(predictions_immune_response = predictions_immune_response,
                        real_patient_response = Riaz_data$patient_response,
                        RNA_tpm = Riaz_data$tpm_RNAseq,
                        output_file_path = "/Users/Oscar/Desktop/Riaz",
                        cancertype = cancertype)
```

## Analyze systems biomarkers of immune response

```{r eval = FALSE}
explore_biomarkers(pathways = pathways_scores,
                   immunecells = cell_fractions,
                   # lrpairs = lrpairs_weights,
                   # tfs = tfs_scores,
                   # ccpairsgroupedscores = ccpairsgrouped_scores,
                   cancertype = cancertype,
                   real_patient_response = Riaz_data$patient_response,
                   output_file_path = "/Users/Oscar/Desktop/Riaz")
```

# Session info {-}

```{r}
sessionInfo()
```

