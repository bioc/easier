% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rmtlr_test.R
\name{rmtlr_test}
\alias{rmtlr_test}
\title{Regularized Multi-Task Linear Regression (RMTLR) model predictions}
\usage{
rmtlr_test(x_test, coef_matrix)
}
\arguments{
\item{x_test}{numeric matrix containing features values (rows = samples; columns = features).}

\item{coef_matrix}{numeric matrix containing the parameters values derived from model training
(rows = features; columns = tasks).}
}
\value{
Numeric matrix of predicted values (rows = samples; columns = tasks).
}
\description{
Computes the predictions from the results of RMTLR models optimization
}
\examples{
# Load exemplary dataset (Mariathasan et al., Nature, 2018) from easierData.
# Original processed data is available from IMvigor210CoreBiologies package.
library("easierData")
dataset_mariathasan <- easierData::get_Mariathasan2018_PDL1_treatment()
RNA_tpm <- dataset_mariathasan@assays@data@listData[["tpm"]]

# Select a subset of patients to reduce vignette building time.
set.seed(1234)
subset <- sample(colnames(RNA_tpm), size = 30)
RNA_tpm <- RNA_tpm[, subset]

# Computation of cell fractions (Finotello et al., Genome Med, 2019)
cell_fractions <- compute_cell_fractions(RNA_tpm = RNA_tpm)

# Parameters values should be defined with features as rows and tasks as columns
estimated_parameters <- matrix(rnorm(n = (ncol(cell_fractions) + 1) * 10),
  nrow = ncol(cell_fractions) + 1, ncol = 10
)
rownames(estimated_parameters) <- c("(Intercept)", colnames(cell_fractions))
colnames(estimated_parameters) <- c(
  "CYT", "Ock_IS", "Roh_IS", "chemokines",
  "Davoli_IS", "IFNy", "Ayers_expIS", "Tcell_inflamed", "RIR", "TLS"
)

# Compute predictions using parameters values
pred_test <- rmtlr_test(
  x_test = cell_fractions,
  coef_matrix = estimated_parameters
)
}
